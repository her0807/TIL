## JVM  실행 과정 이해하기 





> #### JVM 이란?
>
> ---
>
> 
>
> Java Virtual Machine 으로 Java byte code를 OS 에 맞게 해석해 주는 역할을 한다.
>
> JVM은 역할은 다음과 같다.
>
> - 바이너리 코드를 읽는다.
> - 바이너리 코드를 검증한다.
> - 바이너리 코드를 실행한다.
> - 실행환경(Runtime Environment)의 규격을 제공한다. (필요한 라이브러리 및 기타파일)







------



> #### 컴파일 하는 방법
>
> ------
>
> 
>
> - 자바에서의 컴파일은 자바 언어로 된 코드를 JVM이 인식할 수 있는 명령어코드(바이트코드)로 변환하는 것을 의미
>
> - JDK를 설치하면 javac라는 자바 컴파일러가 포함되어있다.
>
> - 자바 소스 파일(.java) -> javac 컴파일러 -> JVM 바이트코드(.class)
>
>   ```
>   javac 파일명.java
>   ```

------



> #### 실행방법
>
> - java 명령어를 사용해서 파일 실행
>
>   ```
>   java 파일명.java
>   ```
>
> 

------



> #### 바이트 코드
>
> - 가상머신이 이해하는 언어로 변환된 자바 소스코드
>
> - 자바 가상머신이 설치되어 있으면 어떤 운영체제에서도 실행 가능
>
>   

------



> #### JIT 컴파일러
>
> ------
>
> 
>
> - 프로그램 실행 중에 (run time 중에) 가상 기계 상에서만 돌아가는 자바 바이트 코드를 해당 플랫폼에 맞는 기계어로 컴파일해주는 특수한 컴파일러.
> - 실행에 비교적 많은 시간이 걸리는 바이트코드를 JIT컴파일러로 컴파일 함으로써 실행속도를 향상시킨다.
>
> ##### 작동방법
>
> - 프로그램이 실행되면 JRE안에 존재하면서 프로그램을 실행할 때 기계어로 번역해 전달한다.
> - 같은 코드를 매번 해석하지 않고 실핼할 때 컴파일을 하면서 해당코드를 캐싱
>
> 

------



> #### **JVM 구성 요소**
>
> ------
>
> ​	**Class Loader**
>
> ​	JVM 내로 클래스 파일을 load하고 link를 통해 배치를 수행하는 모듈로 Runtime 시에 동적으로 클래스를 로드	한다. 
>
> ​	자바는 동적 코드, 컴파일 타임이 아니라 런타임에 참조한다.
>
> ​	즉, 클래스를 처음으로 참조할 때 해당 클래스를 load하고 link한다.
>
>  
>
> ​	**Execution Engine**
>
> ​	class loader를 통해 배치된 클래스를 실행시킨다.
>
> ​	클래스 파일(바이트 코드)은 비교적 인간이 보기 쉬운 형태이기 때문에 기계가 실행할 수 있는 형태로 변경 
>
> ​	이 때, 두 가지 방식을 사용한다. ( 인터프리터, JIT )
>
>  
>
> ​	**Interpreter**
>
> ​	실행 엔진은 바이트 코드를 명령어 단위로 실행한다.
>
> ​	이는 한 줄 씩 수행하기 때문에 느리다는 단점을 가지고 있다.
>
>  
>
> ​	**JIT (Just In Time) Compiler**
>
> ​	Interpreter 방식으로 실행하다가 적절한 시점에 바이트 코드 전체를 컴파일 하여 네이티브 코드로 변경,
>
> ​	더 이상 Interpreting 하지 않고 네이티브 코드로 직접 실행하는 방식이다.
>
> ​	네이티브 코드는 캐시에 보관되기 때문에 한 번 컴파일된 코드는 빠르게 실행할 수 있다.
>
> ​	물론 한 번만 실행되는 코드라면 JIT 보다 Interpreter 방식이 유리하다.
>
> ​	따라서 JVM은 해당 메소드가 얼마나 자주 수행되는지 체크하고, 일정 정도를 넘을 때 컴파일을 수행한다.
>
>  
>
> ​	**Garbage Collector**
>
> ​	동적으로 할당된 메모리 중 사용되지 않는 메모리를 반환한다.
>
> ​	실행 시기는 JVM이 OS에 메모리를 추가적으로 요청했을 때 실행되고,
>
> ​	24시간 내내 돌아가는 서버 프로그램의 경우, JVM이 한가한 시점에 실행된다.



------



> ### 	JDK와 JRE의 차이
>
> ------
>
> 
>
> - **JDK = JRE + @**
> - **JRE는 읽기** 전용, **JDK 읽기 / 쓰기** 전용이라 생각할 수 있다.
>
> 
>
> 1. **JDK** (Java Development Kit)
>
>    - 자바 프로그래밍시 필요한 컴파일러 등 포함
>
>    - Java 프로그래밍을 하기 위해서는 JDK를 설치해야 한다.
>
>    - JDK를 설치하면 JRE도 같이 설치가 된다.
>
>      
>
> 2. **JRE** (Java Runtime Environment)
>
>    - 컴파일된 자바 프로그램을 실행시킬 수 있는 자바 환경
>    - 자바 프로그램을 **실행**시키기 위해선 JRE를 반드시 설치해야한다.

